import {Component, Player, CodeBlockEvents, PropTypes, Entity, Vec3,} from "horizon/core";
import {Events} from "./GameUtilities";
import {UIComponent, UINode, View, ImageSource, Image, Binding, DimensionValue, DynamicList} from "horizon/ui";


const UPSCALE = 250;

interface DotLocation{
  x: number;
  y: number;
}
//TODO GENERATE ARRAY ON EACH CYCLE


class PacmanUI extends UIComponent {
  panelWidth = 1920;
  panelHeight = 1080;
  private pacman: Entity|undefined;
  private enemy1: Entity|undefined;
  private enemy2: Entity|undefined;
  private enemy3: Entity|undefined;
  private enemy4: Entity|undefined;

  private origin: Vec3|undefined;

  private allDots: Entity[] = [];
  private visibleDots: Entity[] = [];

  private dotDisplay = new Binding<DotLocation[]>([]);




  private pacManX = new Binding<DimensionValue>(0);
  private pacManY = new Binding<DimensionValue>(0);
  private enemy1X = new Binding<DimensionValue>(0);
  private enemy1Y = new Binding<DimensionValue>(0);
  private enemy2X = new Binding<DimensionValue>(0);
  private enemy2Y = new Binding<DimensionValue>(0);
  private enemy3X = new Binding<DimensionValue>(0);
  private enemy3Y = new Binding<DimensionValue>(0);
  private enemy4X = new Binding<DimensionValue>(0);
  private enemy4Y = new Binding<DimensionValue>(0);


  static propsDefinition = {
    trackingOrigin: {type: PropTypes.Entity},
    pacmanSuit: {type: PropTypes.Entity},
    enemy1Suit: {type: PropTypes.Entity},
    enemy2Suit: {type: PropTypes.Entity},
    enemy3Suit: {type: PropTypes.Entity},
    enemy4Suit: {type: PropTypes.Entity},
    backgroundImage: {type: PropTypes.Asset},
    playerImage: {type: PropTypes.Asset},
    enemy1Image: {type: PropTypes.Asset},
    enemy2Image: {type: PropTypes.Asset},
    enemy3Image: {type: PropTypes.Asset},
    enemy4Image: {type: PropTypes.Asset},
    pacDotImage: {type: PropTypes.Asset},
  };
  initializeUI(): UINode {
    const backgroundImage: ImageSource = ImageSource.fromTextureAsset(this.props.backgroundImage);
    const playerImage: ImageSource = ImageSource.fromTextureAsset(this.props.playerImage);
    const enemy1Image: ImageSource = ImageSource.fromTextureAsset(this.props.enemy1Image);
    const enemy2Image: ImageSource = ImageSource.fromTextureAsset(this.props.enemy2Image);
    const enemy3Image: ImageSource = ImageSource.fromTextureAsset(this.props.enemy3Image);
    const enemy4Image: ImageSource = ImageSource.fromTextureAsset(this.props.enemy4Image);
    const pacDotImage: ImageSource = ImageSource.fromTextureAsset(this.props.pacDotImage);

    // TODO make an array with a spread

    return View({children:[
        Image({source: backgroundImage, style:{width: 1920, height: 1080, top: 0, left: 0, position: "absolute", zIndex: -1}}),
        Image({source: playerImage, style:{width: 32, height: 32, bottom: this.pacManX, left: this.pacManY, position: "absolute", zIndex: 1}}),
        Image({source: enemy1Image, style:{width: 32, height: 32, bottom: this.enemy1X, left: this.enemy1Y, position: "absolute", zIndex: 1}}),
        Image({source: enemy2Image, style:{width: 32, height: 32, bottom: this.enemy2X, left: this.enemy2Y, position: "absolute", zIndex: 1}}),
        Image({source: enemy3Image, style:{width: 32, height: 32, bottom: this.enemy3X, left: this.enemy3Y, position: "absolute", zIndex: 1}}),
        Image({source: enemy4Image, style:{width: 32, height: 32, bottom: this.enemy4X, left: this.enemy4Y, position: "absolute", zIndex: 1}}),


        // Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 1, left: 1, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 2, left: 2, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 3, left: 3, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 4, left: 4, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 5, left: 5, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 6, left: 6, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 7, left: 7, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 8, left: 8, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 9, left: 9, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 10, left: 10, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 11, left: 11, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 12, left: 12, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 13, left: 13, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 14, left: 14, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 15, left: 15, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 16, left: 16, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 17, left: 17, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 18, left: 18, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 19, left: 19, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 20, left: 20, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 21, left: 21, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 22, left: 22, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 23, left: 23, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 24, left: 24, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 25, left: 25, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 26, left: 26, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 27, left: 27, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 28, left: 28, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 29, left: 29, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 30, left: 30, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 31, left: 31, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 32, left: 32, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 33, left: 33, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 34, left: 34, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 35, left: 35, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 36, left: 36, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 37, left: 37, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 38, left: 38, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 39, left: 39, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 40, left: 40, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 41, left: 41, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 42, left: 42, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 43, left: 43, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 44, left: 44, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 45, left: 45, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 46, left: 46, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 47, left: 47, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 48, left: 48, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 49, left: 49, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 50, left: 50, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 51, left: 51, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 52, left: 52, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 53, left: 53, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 54, left: 54, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 55, left: 55, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 56, left: 56, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 57, left: 57, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 58, left: 58, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 59, left: 59, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 60, left: 60, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 61, left: 61, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 62, left: 62, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 63, left: 63, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 64, left: 64, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 65, left: 65, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 66, left: 66, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 67, left: 67, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 68, left: 68, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 69, left: 69, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 70, left: 70, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 71, left: 71, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 72, left: 72, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 73, left: 73, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 74, left: 74, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 75, left: 75, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 76, left: 76, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 77, left: 77, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 78, left: 78, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 79, left: 79, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 80, left: 80, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 81, left: 81, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 82, left: 82, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 83, left: 83, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 84, left: 84, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 85, left: 85, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 86, left: 86, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 87, left: 87, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 88, left: 88, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 89, left: 89, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 90, left: 90, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 91, left: 91, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 92, left: 92, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 93, left: 93, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 94, left: 94, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 95, left: 95, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 96, left: 96, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 97, left: 97, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 98, left: 98, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 99, left: 99, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 100, left: 100, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 101, left: 101, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 102, left: 102, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 103, left: 103, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 104, left: 104, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 105, left: 105, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 106, left: 106, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 107, left: 107, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 108, left: 108, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 109, left: 109, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 110, left: 110, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 111, left: 111, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 112, left: 112, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 113, left: 113, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 114, left: 114, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 115, left: 115, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 116, left: 116, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 117, left: 117, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 118, left: 118, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 119, left: 119, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 120, left: 120, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 121, left: 121, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 122, left: 122, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 123, left: 123, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 124, left: 124, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 125, left: 125, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 126, left: 126, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 127, left: 127, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 128, left: 128, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 129, left: 129, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 130, left: 130, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 131, left: 131, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 132, left: 132, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 133, left: 133, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 134, left: 134, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 135, left: 135, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 136, left: 136, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 137, left: 137, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 138, left: 138, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 139, left: 139, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 140, left: 140, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 141, left: 141, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 142, left: 142, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 143, left: 143, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 144, left: 144, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 145, left: 145, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 146, left: 146, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 147, left: 147, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 148, left: 148, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 149, left: 149, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 150, left: 150, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 151, left: 151, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 152, left: 152, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 153, left: 153, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 154, left: 154, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 155, left: 155, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 156, left: 156, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 157, left: 157, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 158, left: 158, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 159, left: 159, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 160, left: 160, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 161, left: 161, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 162, left: 162, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 163, left: 163, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 164, left: 164, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 165, left: 165, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 166, left: 166, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 167, left: 167, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 168, left: 168, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 169, left: 169, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 170, left: 170, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 171, left: 171, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 172, left: 172, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 173, left: 173, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 174, left: 174, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 175, left: 175, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 176, left: 176, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 177, left: 177, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 178, left: 178, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 179, left: 179, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 180, left: 180, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 181, left: 181, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 182, left: 182, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 183, left: 183, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 184, left: 184, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 185, left: 185, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 186, left: 186, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 187, left: 187, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 188, left: 188, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 189, left: 189, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 190, left: 190, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 191, left: 191, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 192, left: 192, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 193, left: 193, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 194, left: 194, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 195, left: 195, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 196, left: 196, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 197, left: 197, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 198, left: 198, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 199, left: 199, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 200, left: 200, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 201, left: 201, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 202, left: 202, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 203, left: 203, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 204, left: 204, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 205, left: 205, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 206, left: 206, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 207, left: 207, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 208, left: 208, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 209, left: 209, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 210, left: 210, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 211, left: 211, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 212, left: 212, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 213, left: 213, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 214, left: 214, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 215, left: 215, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 216, left: 216, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 217, left: 217, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 218, left: 218, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 219, left: 219, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 220, left: 220, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 221, left: 221, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 222, left: 222, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 223, left: 223, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 224, left: 224, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 225, left: 225, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 226, left: 226, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 227, left: 227, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 228, left: 228, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 229, left: 229, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 230, left: 230, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 231, left: 231, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 232, left: 232, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 233, left: 233, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 234, left: 234, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 235, left: 235, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 236, left: 236, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 237, left: 237, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 238, left: 238, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 239, left: 239, position: "absolute", zIndex: 2}}),Image({source: pacDotImage, style:{width: 32, height: 32, bottom: 240, left: 240, position: "absolute", zIndex: 2}}),

      ], style: {position: "absolute", width: "100%", height: "100%"}});
  }



  preStart() {
    this.connectNetworkEvent(this.entity, Events.assignPlayer, (payload: {player: Player}) => {this.assignPlayer(payload.player)});
    this.connectNetworkEvent(this.entity, Events.unassignPlayer, ()=>{this.unassignPlayer()});
    this.connectNetworkBroadcastEvent(Events.registerPacDot, (payload: {pacDot: Entity})=>{
      console.log("Event was received for registration by PacmanUI")
      this.registerPacDot(payload.pacDot);});
  }
  start() {
    // this.connectCodeBlockEvent(this.entity, CodeBlockEvents.OnPlayerEnterWorld, (player: Player) => {this.entity.owner.set(player); this.assignPlayer(player);});
    // if (this.entity.owner.get().id != this.world.getServerPlayer().id){this.assignPlayer(this.entity.owner.get())}
    this.pacman = this.props.pacmanSuit;
    this.enemy1 = this.props.enemy1Suit;
    this.enemy2 = this.props.enemy2Suit;
    this.enemy3 = this.props.enemy3Suit;
    this.enemy4 = this.props.enemy4Suit;

    const originRef: Entity = this.props.trackingOrigin;
    this.origin = originRef.position.get();

    this.async.setInterval(this.updatePositions.bind(this),1_000);
  }
  updatePositions(){

    // TODO these lines are for testing
    const originRef: Entity = this.props.trackingOrigin;
    this.origin = originRef.position.get();
    // TODO end test


    const pacPos = this.pacman!.position.get().sub(this.origin!).mul(UPSCALE);
    // console.log("Pacman", pacPos.x, pacPos.y, pacPos.z);
    const e1Pos = this.enemy1!.position.get().sub(this.origin!).mul(UPSCALE);
    // console.log("e1Pos", e1Pos.x, pacPos.y, pacPos.z);
    const e2Pos = this.enemy2!.position.get().sub(this.origin!).mul(UPSCALE);
    // console.log("e2Pos", e2Pos.x, pacPos.y, pacPos.z);
    const e3Pos = this.enemy3!.position.get().sub(this.origin!).mul(UPSCALE);
    // console.log("e3Pos", e3Pos.x, pacPos.y, pacPos.z);
    const e4Pos = this.enemy4!.position.get().sub(this.origin!).mul(UPSCALE);
    // console.log("e4Pos", e4Pos.x, pacPos.y, pacPos.z);
    this.pacManY.set(pacPos.x as DimensionValue);
    this.pacManX.set(pacPos.z as DimensionValue);
    this.enemy1Y.set(e1Pos.x as DimensionValue);
    this.enemy1X.set(e1Pos.z as DimensionValue);
    this.enemy2Y.set(e2Pos.x as DimensionValue);
    this.enemy2X.set(e2Pos.z as DimensionValue);
    this.enemy3Y.set(e3Pos.x as DimensionValue);
    this.enemy3X.set(e3Pos.z as DimensionValue);
    this.enemy4Y.set(e4Pos.x as DimensionValue);
    this.enemy4X.set(e4Pos.z as DimensionValue);

  }


  assignPlayer(p: Player) {


  }
  unassignPlayer() {
    this.entity.owner.set(this.world.getServerPlayer());
  }

  registerPacDot(pacDot: Entity) {
    console.log("Registering a Pac Dot from PacmanUI");
    this.allDots.push(pacDot);
    //TODO for testingPurposes
    this.visibleDots = [...this.allDots];
    this.updateDisplayDots()
  }
  updateDisplayDots(){
    const dotsToDisplay: DotLocation[] = [];
    this.visibleDots.forEach(dot => {
      const dotPosition = dot.position.get().sub(this.origin!);
      // const dotPosition = dot.position.get().sub(this.origin!).mul(UPSCALE);
      const newDot: DotLocation = {x: dotPosition.z, y: dotPosition.x};
      console.log(newDot);
      dotsToDisplay.push(newDot);
    });
    this.dotDisplay.set(dotsToDisplay);
  }

}
Component.register(PacmanUI);